{% extends "layout.html" %} 
{% block title %} 
Create Quiz
{% endblock %} 
{% block main %}
<h1>Create your own quiz!</h1>
<div class="container">
    <form action="/create" method="POST">
        <div class="field-row">
            <label class="create-label" for="title">Title:</label>
            <input
                name="title"
                id="title"
                autocomplete="off"
                class="field"
                type="text"
                value="{{ title }}"
                maxlength="100"
            />
        </div>
        <div class="field-row">
            <label class="create-label" for="quiztype">Type:</label>
            <input
                name="quiztype"
                id="bool"
                type="radio"
                value="bool"
                {% if quiztype %}
                    {% if quiztype == "bool" %}checked{% endif %}
                {% endif %}
            />
            <label for="bool">True/False</label>
            <input
                name="quiztype"
                id="multiple"
                type="radio"
                value="multi"
                {% if quiztype %}
                    {% if quiztype == "multi" %}checked{% endif %}
                {% endif %}
            />  
            <label for="multi">Multiple Options</label>
            <input
                name="quiztype"
                id="enter"
                type="radio"
                value="enter"
                {% if quiztype %}
                    {% if quiztype == "enter" %}checked{% endif %}
                {% endif %}
            />
            <label for="enter">Enter Answer</label> 
            <label class="create-label" for="category">Category:</label>
            <select id="category" name="category" onchange="saveSelected()">
                {% for category in categories %}
                    <option value="{{ category }}">
                        {{ category }}
                    </option>
                {% endfor %}
            </select>
        </div>
        <div class="field-row">
            <label class="create-label" for="amount">Number of questions:</label>
            <input
                name="amount"
                id="amount"
                class="field"
                type="number"
                value="{{ amount }}"
                placeholder="Max 30"
            />
            <label class="create-label" for="time">Time Limit:</label>
            <input
                name="time"
                id="time"
                class="field"
                type="number"
                value="{{ time }}"
            />
        </div>
        {% with message = get_flashed_messages(category_filter=["failCreate"]) %} 
            {% if message %}
                <div class="field-row center">
                    <span class="failureMsg">
                        <i class="fas fa-exclamation-triangle icon"></i>{{ message | join(" ") }}
                    </span>
                </div>
            {% endif %}
        {% endwith %}
        <div class="field-row center">
            <button class="field-btn" type="submit">Generate</button>
        </div>
    </form>
    <form action="/submit" method="POST">
        {% if generate_questions %}
            <ul>
                {% for i in range(amount) %}
                    <div class="field-row center">
                        <li class="q-list center">
                            <label class="create-label" for="question{{ i+1 }}">Question {{ i+1 }}:</label> 
                            <input
                            name="question{{ i+1 }}"
                            class="field"
                            type="text"
                            maxlength="255"
                            {% if questions %}
                            value="{{ questions[i] }}"
                            {% endif %}
                            />
                            {% if quiztype == "bool" %}
                                <label class="create-label" for="bool{{ i+1 }}">Answer:</label>
                                <input 
                                    name="bool{{ i+1 }}"
                                    type="radio" 
                                    value="true"
                                    {% if answers %}
                                        {% if answers[i] == "true" %}
                                            checked
                                        {% endif %}
                                    {% endif %}
                                    >
                                <label for="false">True</label>
                                <input 
                                    name="bool{{ i+1 }}"
                                    type="radio" 
                                    value="false"
                                    {% if answers %}
                                        {% if answers[i] == "false" %}
                                            checked
                                        {% endif %}
                                    {% endif %}
                                    >
                                <label for="false">False</label>
                            {% endif %}
                            {% if quiztype == "enter" %}
                            <label class="create-label" for="answer{{ i+1 }}">Answer:</label> 
                            <input
                            name="answer{{ i+1 }}"
                            class="field"
                            type="text"
                            maxlength="100"
                            {% if answers %}value="{{ answers[i] }}"{% endif %}
                            />
                            {% endif %}
                    </div>
                    {% if quiztype == "multi" %}
                        <div class="field-row">
                            {% for j in range(3) %}
                                <label class="create-label" for="answer{{ i+1 }}{{ j+1 }}">Answer {{ j+1 }}:</label> 
                                <input
                                    name="answer{{ i+1 }}_{{ j+1 }}"
                                    class="field"
                                    type="text"
                                    maxlength="100"
                                    {% if answers %}
                                        value="{{ answers[i][j] }}"
                                    {% endif %}
                                />
                            {% endfor %}
                        </div>
                        <div class="field-row">
                            <h2>Correct answer:</h2>
                            {% for n in range(3) %}
                                <label class="create-label" for="correct{{ i+1 }}_{{ n+1 }}">{{ n+1 }}:</label>
                                <input
                                    name="correct{{ n+1 }}"
                                    id="correct{{ i+1 }}_{{ n+1 }}"
                                    class="field"
                                    type="radio"
                                    value="option{{ n+1 }}"
                                    {% if correct_option and correct_option[i] == "option1" %}
                                        checked
                                    {% endif %}
                                />
                            {% endfor %}
                        </div>
                    {% endif %}
                        </li>
                    <hr>
                {% endfor %}
            </ul>
            {% with message = get_flashed_messages(category_filter=["failSubmit"]) %} 
                {% if message %}
                    <div class="field-row center">
                        <span class="failureMsg">
                            <i class="fas fa-exclamation-triangle icon"></i>{{ message | join(" ") }}
                        </span>
                    </div>
                {% endif %}
            {% endwith %}
            <div class="field-row center">
                <button class="field-btn" type="submit">Submit</button>
            </div>
        {% endif %}
    </form>
</div>
{% endblock %}